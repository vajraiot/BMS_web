package com.bms;

import java.sql.*;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

import org.hibernate.Criteria;
import org.hibernate.Session;
import org.hibernate.Transaction;
import org.hibernate.criterion.Order;
import org.hibernate.query.Query;

import com.bms.hibernate.service.BMSAlarmStatusService;
import com.bms.hibernate.service.BatteryMonitoringDataService;
import com.bms.hibernate.service.CellTemperatureDataService;
import com.bms.hibernate.service.CellVoltageDataService;
import com.bms.hibernate.service.GeneralDataService;
import com.bms.hibernate.service.RawdataParsedService;
import com.bms.hibernate.service.RawdataService;
import com.bms.hibernate.util.HibernateUtil;
import com.bms.miscellaneous.PacketType;
import com.bms.model.BMSAlarmStatus;
import com.bms.model.BatteryMonitoringData;
import com.bms.model.CellVoltageData;
import com.bms.model.GeneralData;
import com.bms.model.Rawdata;
import com.bms.packetTypeParse.BMSAlarmStatusParser;
import com.bms.packetTypeParse.BatteryMonitoringDataParser;
import com.bms.packetTypeParse.CellVoltageDataParser;
import com.bms.packetTypeParse.GeneralDataParser;
import com.bms.pojo.BatteryMonitoringDataWithLastIndex;
import com.bms.pojo.RawdataDTO;
import com.bms.pojo.RawdataParsedDTO;
import com.bms.server.DMSSocketServer;
import com.bms.utilities.Converters;
/**
 * Hello world!
 *
 */
public class VJBMSTcpListenerMain 
{
	
	static String packet="242C4F5453492C31313A30333A33302C32352F30392F323031392C38393931313330303030303137383335373137332C3130302E3132312E3135372E31322C3430343037303736313232353537393030302C4C4D502C4F5453492C4656312E30332C4E522C30312C4C2C3335333633353038303732373939392C415031364147313937382C312C3235303931392C3035333233302C313732352E313731342C4E2C30373832342E303632382C452C302E302C302E302C30332C3634352E332C312E362C312E362C2249444541222C302C312C30332E31352C30312E30302C302C4F2C31342C3430342C30372C323730432C463334372C0D0A234D4F4E493A2043656C6C20204253494320204C4143202043656C6C49642020415246434E20202020506F776572202043312020433220205441202052785175616C2020504C4D4E0D0A234D4F4E493A202053202020203137202032373043202020463334372020202020373531202020202D383964626D202020202031372020313720202D3120202020203720202020494445410D0A234D4F4E493A204E31202020203237202030303243202020354146422020202020203230202020202D383664626D20202020202D3120202D310D0A234D4F4E493A204E32202020203232202030303243202020354146432020202020203233202020202D383464626D20202020202D3120202D310D0A234D4F4E493A204E33202020203530202030333742202020354135332020202020203139202020202D383764626D20202020202D3120202D310D0A234D4F4E493A204E34202020203235202030333742202020453831352020202020203136202020202D383564626D20202020202D3120202D310D0A234D4F4E493A204E35202020203331202030303243202020463343342020202020203134202020202D383664626D20202020202D3120202D310D0A234D4F4E493A204E362020202046462020464646462020203030303020202020202020302020202D31313164626D20202020202D2C313131312C30302C3036353237392C414142422C3030302E3030302E3030302E3030302C303030303030303030302C303030302C30303030303030302C30302C414141414141414141412C302C3131303030303030313030313031303030303030303030302C30303030303030302C2A";
	
    public static void main( String[] args )
    {    
    	
    	

      serverRunnig();
      //localRunning();
      // testmethods();
    	//testmethods();
    	//hibernateTesting();
    }
    
public static void hibernateTesting()
{
	//GeneralData inst=new GeneralDataService().getLatestGeneralData();	
	GeneralData inst=new GeneralDataService().getGeneralDataTest();
   System.out.println("data is:"+inst.toString());
	//BatteryMonitoringData btm=  new BatteryMonitoringDataService().getBatteryMonitoringData();
//	System.out.println("data is:"+btm.toString());

}
   
    
  
    public static void localRunning()
    {
    //	new RawDataProcessing().packetProcess("242C564A52412C31323A31343A30302C30352F31312F323031392C38393931303030393032333637373330303939462C3130302E38342E3131302E3137302C3430343439303639353433383233333030302C4C4D502C564A52412C4656312E30312C4E522C30312C4C2C3335333633353038303639393933332C415033384141303030312C312C3035313131392C3036343532352C313732372E313439392C4E2C30373832332E323732312C452C302E302C302E302C30322C3531342E322C322E322C322E322C22494E442061697274656C222C312C312C30302E30302C30302E30302C302C432C32392C3430342C34392C344632462C424530332C0D0A234D4F4E493A2043656C6C20204253494320204C4143202043656C6C49642020415246434E20202020506F776572202043312020433220205441202052785175616C2020504C4D4E0D0A234D4F4E493A202053202020203433202034463246202020424530332020202020203730202020202D353664626D202020202034352020343520202D3120202020203020202020494E442061697274656C0D0A234D4F4E493A204E31202020203731202034463246202020353631392020202020203236202020202D363664626D20202020202D3120202D310D0A234D4F4E493A204E32202020203636202034463246202020424530322020202020203635202020202D353664626D20202020202D3120202D310D0A234D4F4E493A204E33202020204646202046464646202020303030302020202020203239202020202D353964626D20202020202D3120202D310D0A234D4F4E493A204E34202020203534202034463246202020374243422020202020203637202020202D363964626D20202020202D3120202D310D0A234D4F4E493A204E35202020203637202034463246202020393234312020202020203330202020202D363764626D20202020202D3120202D310D0A234D4F4E493A204E362020202046462020464646462020203030303020202020202020302020202D31313164626D2C303030302C30302C3030303031362C414142422C3030302E3030302E3030302E3030302C303030303030303030302C303030302C30303030303030302C30302C414141414141414141412C302C3030303030303030303030303030303030303030303030302C30303030303030302C2A01000147414655454C53454E534F5235000AE60000067203130000054600000001040B130C0F050000000000007717001D0000A4B1002100000110000000000000000000000000000000000000000000000000");
    	
    	
    //	GeneralData _GeneralData=new GeneralDataParser().parseData("2355502C474152424D53303030312C31363A33343A30302C31372F31322F323031392C30000B56414A5241424D53313930303133302F30332F323031380001050A2020FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0000005C41F93BAD0000000000000000423BF69E41CC04F842CB4C6C00000000000015363FA156703FE14AED00000000000000000000000600000000016401520000000027882E");
    	//System.out.println(_GeneralData.toString());
    	//String packet="2355502C474152424D53303030312C31363A33343A30302C31372F31322F323031392C30000B56414A5241424D53313930303133302F30332F323031380001050A2020FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0000005C41F93BAD0000000000000000423BF69E41CC04F842CB4C6C00000000000015363FA156703FE14AED00000000000000000000000600000000016401520000000027882E";
    	
      String errorPacket="23474156303156414A5241494F54313233343536372C31353A30383A33312C30332F30312F323032302C0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E0000000032E";
    	//String errorPacket="2355462C56414A524157424D53312C31323A35303A30382C31392F31322F323031392C30000B56414A524157424D533030303131382F31322F32303139000506082020FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF132E03EB41FC41E742AFD2D44084D82E4173D95341CE97DF44030E3B000000AA000006CC3E57CDC74097F0860000000041968BD50000000900000000014E030107150000E28631000B56414A524157424D533030303131382F31322F32303139000506082020FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF132E03EB41FC41E742AFD2D44084D82E4173D95341CE97DF44030E3B000000AA000006CC3E57CDC74097F0860000000041968BD50000000900000000014E030107150000E2862E";
    	new BMSDataProcessing().packetProcess(errorPacket);
      
 //     BMSAlarmStatus _bMSAlarmStatus=new BMSAlarmStatusParser().parse("00030200");
    //  System.out.println("data:"+_bMSAlarmStatus.toString());
    	//int bytecount=36;
    	//BatteryMonitoringDataWithLastIndex _batteryMonitoringDataWithLastIndex=new BatteryMonitoringDataParser().parse(bytecount, packet);
    	
    	//List<CellVoltageData> _listCellVoltageData=new ArrayList<CellVoltageData>();
    //	 Collections.copy(_listCellVoltageData, _batteryMonitoringDataWithLastIndex.getBatteryMonitoringData().getCellVoltageData()); 
    	//_listCellVoltageData=_batteryMonitoringDataWithLastIndex.getBatteryMonitoringData().getCellVoltageData();
    	
       
    	//System.out.println("bytecount "+bytecount);
    	
    	//BMSAlarmStatus _bMSAlarmStatus= new BMSAlarmStatusParser().parse("0001050A");
    //	System.out.println(_bMSAlarmStatus.toString());
    	
    	//String cellvoltagePacket="FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF";
    	//String celltempPacket="FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF";
      
    	//new CellVoltageDataParser().parse(cellvoltagePacket);
    	
    }

	public static void testmethods() {
		//new FTMSDataProcessing().packetProcess("242C4F5453492C31313A33383A33312C32352F31302F323031392C38393931303030393032333637373330303939462C3130302E39302E3135332E3137332C3430343439303639353433383233333030302C4C4D502C4F5453492C4656312E30332C4E522C30312C4C2C3335333633353038303639393933332C303030312C312C3030303030302C3030303030302C3030303030302E303030302C4E2C303030303030302E303030302C452C30302E302C3030302E30302C30302C3030302E30302C302E302C302E302C22494E442061697274656C222C302C312C33372E35352C30312E30302C302C4F2C32392C3430342C34392C344632462C433032392C0D0A234D4F4E493A2043656C6C20204253494320204C4143202043656C6C49642020415246434E20202020506F776572202043312020433220205441202052785175616C2020504C4D4E0D0A234D4F4E493A202053202020203130202034463246202020433032392020202020203236202020202D353564626D202020202034362020343620202D3120202020203020202020494E442061697274656C0D0A234D4F4E493A204E31202020203534202034463246202020433032382020202020203238202020202D373064626D20202020202D3120202D310D0A234D4F4E493A204E32202020203232202034463239202020304438382020202020203638202020202D383064626D20202020202D3120202D310D0A234D4F4E493A204E33202020203235202031423541202020304644362020202020203331202020202D383464626D20202020202D3120202D310D0A234D4F4E493A204E34202020203236202034463239202020423831432020202020203635202020202D383764626D20202020202D3120202D310D0A234D4F4E493A204E35202020203232202034463239202020304438362020202020203730202020202D383664626D20202020202D3120202D310D0A234D4F4E493A204E362020202046462020464646462020203030303020202020202020302020202D31313164626D2C303030302C30302C3039383039342C414142422C3030302E3030302E3030302E3030302C303030303030303030302C303030302C30303030303030302C30302C303030333338313833342C302C3131303030303030313030313031303030303030303030302C30303030303030302C2A2347445630312C544553544741303030322C31353A32343A30372C30352F30332F323031382C11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100014741464D533032313830303032001AB300010AFE02D7400004BA000000000503120F170F000000000001DE10000F0001C37A001500000110000000000000000000000000000000000000000000000000E0000000012E");
		
		//new FTMSDataProcessing().packetProcess("242C4F5453492C31313A33383A33312Caaaaaaaaaaaaaaaaaaaaaaaaaaaaa2222222232352F31302F323031392C38393931303030393032333637373330303939462C3130302E39302E3135332E3137332C3430343439303639353433383233333030302C4C4D502C4F5453492C4656312E30332C4E522C30312C4C2C3335333633353038303639393933332C303030312C312C3030303030302C3030303030302C3030303030302E303030302C4E2C303030303030302E303030302C452C30302E302C3030302E30302C30302C3030302E30302C302E302C302E302C22494E442061697274656C222C302C312C33372E35352C30312E30302C302C4F2C32392C3430342C34392C344632462C433032392C0D0A234D4F4E493A2043656C6C20204253494320204C4143202043656C6C49642020415246434E20202020506F776572202043312020433220205441202052785175616C2020504C4Dd4E0D0A234D4F4E493A202053202020203130202034463246202020433032392020202020203236202020202D353564626D202020202034362020343620202D3120202020203020202020494E442061697274656C0D0A234D4F4E493A204E31202020203534202034463246202020433032382020202020203238202020202D373064626D20202020202D3120202D310D0A234D4F4E493A204E32202020203232202034463239202020304438382020202020203638202020202D383064626D20202020202D3120202D310D0A234D4F4E493A204E33202020203235202031423541202020304644362020202020203331202020202D383464626D20202020202D3120202D310D0A234D4F4E493A204E34202020203236202034463239202020423831432020202020203635202020202D383764626D20202020202D3120202D310D0A234D4F4E493A204E35202020203232202034463239202020304438362020202020203730202020202D383664626D20202020202D3120202D310D0A234D4F4E493A204E362020202046462020464646462020203030303020202020202020302020202D31313164626D2C303030302C30302C3039383039342C414142422C3030302E3030302E3030302E3030302C303030303030303030302C303030302C30303030303030302C30302C303030333338313833342C302C3131303030303030313030313031303030303030303030302C30303030303030302C2A2347445630312C544553544741303030322C31353A32343A30372C30352F30332F323031382C11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100014741464D533032313830303032001AB300010AFE02D7400004BA000000000503120F170F000000000001DE10000F0001C37A001500000110000000000000000000000000000000000000000000000000E0000000012E");
		
		//new ImeiNumbersService().saveImeiNumber("35363508069993344");
		
		//new BMSDataProcessing().packetProcess("2355502C56414A524157424D53322C31343A34393A30342C33302F31322F323031392C30007056414A5241424D53303030303233302F30332F32303138000101042020FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002E"); //present sending bytes 
	
		//FMSData fMSData = new FMSProtocol().parse("242C564A52412C31333A31343A33302C30382F31312F323031392C38393931303030393032333637373330303939462C3130302E38382E31372E3139352C3430343439303639353433383233333030302C4C4D502C564A52412C4656312E30312C4E522C30312C4C2C3335333633353038303639393933332C415033384141303030312C312C3038313131392C3037343630302C313732372E313632312C4E2C30373832332E323637302C452C302E302C302E302C30372C3536332E322C302E372C302E372C22494E442061697274656C222C312C312C30302E30302C30302E30302C302C432C32382C3430342C34392C344632462C424530322C0D0A234D4F4E493A2043656C6C20204253494320204C4143202043656C6C49642020415246434E20202020506F776572202043312020433220205441202052785175616C2020504C4D4E0D0A234D4F4E493A202053202020203636202034463246202020424530322020202020203635202020202D363164626D202020202034302020343020202D3120202020203720202020494E442061697274656C0D0A234D4F4E493A204E31202020203036202034463246202020393234322020202020203730202020202D363264626D20202020202D3120202D310D0A234D4F4E493A204E32202020203130202034463246202020374243442020202020203239202020202D373364626D20202020202D3120202D310D0A234D4F4E493A204E33202020203637202034463246202020393234312020202020203330202020202D373464626D20202020202D3120202D310D0A234D4F4E493A204E34202020203731202034463246202020353631392020202020203236202020202D373664626D20202020202D3120202D310D0A234D4F4E493A204E352020202046462020464646462020203030303020202020202020302020202D31313164626D20202020202D3120202D310D0A234D4F4E493A204E362020202046462020464646462020203030303020202020202020302020202D31313164626D2C303030302C30302C3030303030362C414142422C3030302E3030302E3030302E3030302C303030303030303030302C303030302C30303030303030302C30302C414141414141414141412C302C3030303030303030303030303030303030303030303030302C30303030303030302C2A01000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002E");
		
		new BMSDataProcessing().packetProcess("2355502C56414A524157424D53312C31353A31343A30322C31382F30352F323032302C30000B564A424D53353931323139303132362F31322F3230313900000000200035B5FFFF361B359D35F1357A35F4360C35D2358C35A83622360935A733C835A635853573358435983557364D355C3525351B3568355B355A35CD358A3537355A0020002000210021001E00230022001D001E00200021001A001D0020001D001A001A001D0019001E001E001E001A001D001C001A001D001C0019001C001E001A1121001D4079999A3E8D2E45413EF8273C317E4C44FC606A43A6B40A000260AC0000000A429C0FAA417A8DBF4201498A41C0913F0000009327100000002700010CA50001DCC22E"); //second cell would ffff 
		
	}
    public static void serverRunnig()
    {
    	new DMSSocketServer().portListening(4577);//changed 4577 to 1818 
    }
    public static void  testing()
    {
    	new BMSDataProcessing().packetProcess("testing");
    }

}
